import os
import sys
import csv
import pandas as pd
import pymysql
directory = ""

dictionary = {"acid":"CLX45B","sourceTimeStamp":"2021-02-15T20:11:15Z","msgType":"trackInformation","depArpt":"KLAX","sourceFacility":"CCZY","flightRef":149179172,"fdm:trackInformation":{"nxcm:ncsmRouteData":{"nxcm:rvsmData":{"futureCompliance":True,"equipped":True,"currentCompliance":True},
"nxcm:flightTraversalData2":{"nxce:waypoint":[{"sequenceNumber":1,"longitudeDecimal":-118.41,"latitudeDecimal":33.94},{"sequenceNumber":2,"longitudeDecimal":-118.47,"latitudeDecimal":33.94,"elapsedTime":38},{"sequenceNumber":3,"longitudeDecimal":-118.51,"latitudeDecimal":33.94,"elapsedTime":62},{"sequenceNumber":4,"longitudeDecimal":-118.51,"latitudeDecimal":33.94,"elapsedTime":64},{"sequenceNumber":5,"longitudeDecimal":-118.54,"latitudeDecimal":33.94,"elapsedTime":78},{"sequenceNumber":6,"longitudeDecimal":-118.54,"latitudeDecimal":33.94,"elapsedTime":80},{"sequenceNumber":7,"longitudeDecimal":-118.57,"latitudeDecimal":33.94,"elapsedTime":96},{"sequenceNumber":8,"longitudeDecimal":-118.61,"latitudeDecimal":33.93,"elapsedTime":113},{"sequenceNumber":9,"longitudeDecimal":-118.64,"latitudeDecimal":33.93,"elapsedTime":128},{"sequenceNumber":10,"longitudeDecimal":-118.64,"latitudeDecimal":33.93,"elapsedTime":130},{"sequenceNumber":11,"longitudeDecimal":-118.64,"latitudeDecimal":33.93,"elapsedTime":131},{"sequenceNumber":12,"longitudeDecimal":-118.64,"latitudeDecimal":33.9,"elapsedTime":150},{"sequenceNumber":13,"longitudeDecimal":-118.64,"latitudeDecimal":33.87,"elapsedTime":171},{"sequenceNumber":14,"longitudeDecimal":-118.64,"latitudeDecimal":33.84,"elapsedTime":186},{"sequenceNumber":15,"longitudeDecimal":-118.55,"latitudeDecimal":33.74,"elapsedTime":255},{"sequenceNumber":16,"longitudeDecimal":-118.52,"latitudeDecimal":33.7,"elapsedTime":279},{"sequenceNumber":17,"longitudeDecimal":-118.39,"latitudeDecimal":33.66,"elapsedTime":340},{"sequenceNumber":18,"longitudeDecimal":-118.34,"latitudeDecimal":33.64,"elapsedTime":359},{"sequenceNumber":19,"longitudeDecimal":-118.33,"latitudeDecimal":33.64,"elapsedTime":365},{"sequenceNumber":20,"longitudeDecimal":-118.27,"latitudeDecimal":33.64,"elapsedTime":387},{"sequenceNumber":21,"longitudeDecimal":-118.22,"latitudeDecimal":33.64,"elapsedTime":408},{"sequenceNumber":22,"longitudeDecimal":-118.18,"latitudeDecimal":33.64,"elapsedTime":423},{"sequenceNumber":23,"longitudeDecimal":-118.17,"latitudeDecimal":33.65,"elapsedTime":428},{"sequenceNumber":24,"longitudeDecimal":-118.11,"latitudeDecimal":33.73,"elapsedTime":467},{"sequenceNumber":25,"longitudeDecimal":-118.05,"latitudeDecimal":33.79,"elapsedTime":501},{"sequenceNumber":26,"longitudeDecimal":-118.04,"latitudeDecimal":33.8,"elapsedTime":503},{"sequenceNumber":27,"longitudeDecimal":-117.94,"latitudeDecimal":33.91,"elapsedTime":574},{"sequenceNumber":28,"longitudeDecimal":-117.9,"latitudeDecimal":33.95,"elapsedTime":603},{"sequenceNumber":29,"longitudeDecimal":-117.9,"latitudeDecimal":33.95,"elapsedTime":604},{"sequenceNumber":30,"longitudeDecimal":-117.82,"latitudeDecimal":34.05,"elapsedTime":663},{"sequenceNumber":31,"longitudeDecimal":-117.78,"latitudeDecimal":34.08,"elapsedTime":686},{"sequenceNumber":32,"longitudeDecimal":-117.78,"latitudeDecimal":34.09,"elapsedTime":690},{"sequenceNumber":33,"longitudeDecimal":-117.71,"latitudeDecimal":34.14,"elapsedTime":725},{"sequenceNumber":34,"longitudeDecimal":-117.51,"latitudeDecimal":34.27,"elapsedTime":815},{"sequenceNumber":35,"longitudeDecimal":-117.46,"latitudeDecimal":34.3,"elapsedTime":836},{"sequenceNumber":36,"longitudeDecimal":-117.45,"latitudeDecimal":34.31,"elapsedTime":842},{"sequenceNumber":37,"longitudeDecimal":-117.34,"latitudeDecimal":34.38,"elapsedTime":895},{"sequenceNumber":38,"longitudeDecimal":-117.24,"latitudeDecimal":34.45,"elapsedTime":949},{"sequenceNumber":39,"longitudeDecimal":-117.13,"latitudeDecimal":34.52,"elapsedTime":999},{"sequenceNumber":40,"longitudeDecimal":-117.1,"latitudeDecimal":34.54,"elapsedTime":1013},{"sequenceNumber":41,"longitudeDecimal":-116.82,"latitudeDecimal":34.73,"elapsedTime":1146},{"sequenceNumber":42,"longitudeDecimal":-116.64,"latitudeDecimal":34.85,"elapsedTime":1227},{"sequenceNumber":43,"longitudeDecimal":-115.6,"latitudeDecimal":35.63,"elapsedTime":1720},{"sequenceNumber":44,"longitudeDecimal":-115.5,"latitudeDecimal":35.7,"elapsedTime":1766},{"sequenceNumber":45,"longitudeDecimal":-115.14,"latitudeDecimal":35.96,"elapsedTime":1945},{"sequenceNumber":46,"longitudeDecimal":-114.83,"latitudeDecimal":36.18,"elapsedTime":2095},{"sequenceNumber":47,"longitudeDecimal":-114.07,"latitudeDecimal":36.41,"elapsedTime":2363},{"sequenceNumber":48,"longitudeDecimal":-113.34,"latitudeDecimal":36.63,"elapsedTime":2630},{"sequenceNumber":49,"longitudeDecimal":-112.44,"latitudeDecimal":36.88,"elapsedTime":2947},{"sequenceNumber":50,"longitudeDecimal":-112.35,"latitudeDecimal":36.91,"elapsedTime":2979},{"sequenceNumber":51,"longitudeDecimal":-111.75,"latitudeDecimal":37.08,"elapsedTime":3200},{"sequenceNumber":52,"longitudeDecimal":-111.37,"latitudeDecimal":37.18,"elapsedTime":3338},{"sequenceNumber":53,"longitudeDecimal":-111.22,"latitudeDecimal":37.22,"elapsedTime":3392},{"sequenceNumber":54,"longitudeDecimal":-109.09,"latitudeDecimal":37.77,"elapsedTime":4158},{"sequenceNumber":55,"longitudeDecimal":-108.93,"latitudeDecimal":37.81,"elapsedTime":4214},{"sequenceNumber":56,"longitudeDecimal":-108.65,"latitudeDecimal":37.91,"elapsedTime":4324},{"sequenceNumber":57,"longitudeDecimal":-108.38,"latitudeDecimal":38.01,"elapsedTime":4426},{"sequenceNumber":58,"longitudeDecimal":-108.1,"latitudeDecimal":38.12,"elapsedTime":4522},{"sequenceNumber":59,"longitudeDecimal":-107.54,"latitudeDecimal":38.1,"elapsedTime":4691},{"sequenceNumber":60,"longitudeDecimal":-107.42,"latitudeDecimal":38.09,"elapsedTime":4724},{"sequenceNumber":61,"longitudeDecimal":-106.21,"latitudeDecimal":38.67,"elapsedTime":5228},{"sequenceNumber":62,"longitudeDecimal":-105.39,"latitudeDecimal":38.92,"elapsedTime":5502},{"sequenceNumber":63,"longitudeDecimal":-104.28,"latitudeDecimal":39.35,"elapsedTime":5938},{"sequenceNumber":64,"longitudeDecimal":-104.06,"latitudeDecimal":39.43,"elapsedTime":6022},{"sequenceNumber":65,"longitudeDecimal":-103.62,"latitudeDecimal":39.65,"elapsedTime":6204},{"sequenceNumber":66,"longitudeDecimal":-103.21,"latitudeDecimal":39.74,"elapsedTime":6340},{"sequenceNumber":67,"longitudeDecimal":-103.13,"latitudeDecimal":39.77,"elapsedTime":6367},{"sequenceNumber":68,"longitudeDecimal":-100.53,"latitudeDecimal":40.68,"elapsedTime":7336},{"sequenceNumber":69,"longitudeDecimal":-100.45,"latitudeDecimal":40.73,"elapsedTime":7377},{"sequenceNumber":70,"longitudeDecimal":-99.03,"latitudeDecimal":41.16,"elapsedTime":7884},{"sequenceNumber":71,"longitudeDecimal":-98.35,"latitudeDecimal":41.38,"elapsedTime":8135},{"sequenceNumber":72,"longitudeDecimal":-97.15,"latitudeDecimal":41.82,"elapsedTime":8564},{"sequenceNumber":73,"longitudeDecimal":-96.33,"latitudeDecimal":42.11,"elapsedTime":8855},{"sequenceNumber":74,"longitudeDecimal":-93.98,"latitudeDecimal":42.9,"elapsedTime":9612},{"sequenceNumber":75,"longitudeDecimal":-91.53,"latitudeDecimal":43.65,"elapsedTime":10347},{"sequenceNumber":76,"longitudeDecimal":-90.52,"latitudeDecimal":43.93,"elapsedTime":10629},{"sequenceNumber":77,"longitudeDecimal":-89.72,"latitudeDecimal":44.15,"elapsedTime":10863},{"sequenceNumber":78,"longitudeDecimal":-89.62,"latitudeDecimal":44.18,"elapsedTime":10886},{"sequenceNumber":79,"longitudeDecimal":-88.19,"latitudeDecimal":44.56,"elapsedTime":11272},{"sequenceNumber":80,"longitudeDecimal":-87.66,"latitudeDecimal":44.76,"elapsedTime":11434},{"sequenceNumber":81,"longitudeDecimal":-87.66,"latitudeDecimal":44.76,"elapsedTime":11436},{"sequenceNumber":82,"longitudeDecimal":-86.96,"latitudeDecimal":44.92,"elapsedTime":11599},{"sequenceNumber":83,"longitudeDecimal":-84.47,"latitudeDecimal":45.48,"elapsedTime":12255},{"sequenceNumber":84,"longitudeDecimal":-83.48,"latitudeDecimal":45.66,"elapsedTime":12491},{"sequenceNumber":85,"longitudeDecimal":-83.45,"latitudeDecimal":45.68,"elapsedTime":12501},{"sequenceNumber":86,"longitudeDecimal":-83.34,"latitudeDecimal":45.71,"elapsedTime":12525},{"sequenceNumber":87,"longitudeDecimal":-83.07,"latitudeDecimal":45.79,"elapsedTime":12596},{"sequenceNumber":88,"longitudeDecimal":-82.98,"latitudeDecimal":45.78,"elapsedTime":12615},{"sequenceNumber":89,"longitudeDecimal":-81.17,"latitudeDecimal":46.29,"elapsedTime":13055},{"sequenceNumber":90,"longitudeDecimal":-81,"latitudeDecimal":46.3,"elapsedTime":13095},{"sequenceNumber":91,"longitudeDecimal":-80.32,"latitudeDecimal":46.48,"elapsedTime":13275},{"sequenceNumber":92,"longitudeDecimal":-79.11,"latitudeDecimal":46.79,"elapsedTime":13572},{"sequenceNumber":93,"longitudeDecimal":-78.22,"latitudeDecimal":46.99,"elapsedTime":13801},{"sequenceNumber":94,"longitudeDecimal":-78.14,"latitudeDecimal":47.01,"elapsedTime":13821},{"sequenceNumber":95,"longitudeDecimal":-76.38,"latitudeDecimal":47.35,"elapsedTime":14235},{"sequenceNumber":96,"longitudeDecimal":-73.76,"latitudeDecimal":47.88,"elapsedTime":14876},{"sequenceNumber":97,"longitudeDecimal":-69.42,"latitudeDecimal":48.56,"elapsedTime":15936},{"sequenceNumber":98,"longitudeDecimal":-66.57,"latitudeDecimal":48.98,"elapsedTime":16635},{"sequenceNumber":99,"longitudeDecimal":-63.75,"latitudeDecimal":49.33,"elapsedTime":17318},{"sequenceNumber":100,"longitudeDecimal":-63.5,"latitudeDecimal":49.35,"elapsedTime":17379},{"sequenceNumber":101,"longitudeDecimal":-61.75,"latitudeDecimal":49.53,"elapsedTime":17801},{"sequenceNumber":102,"longitudeDecimal":-59.26,"latitudeDecimal":49.73,"elapsedTime":18392},{"sequenceNumber":103,"longitudeDecimal":-58.43,"latitudeDecimal":49.78,"elapsedTime":18587},{"sequenceNumber":104,"longitudeDecimal":-58.39,"latitudeDecimal":49.78,"elapsedTime":18598},{"sequenceNumber":105,"longitudeDecimal":-57.43,"latitudeDecimal":49.84,"elapsedTime":18821},{"sequenceNumber":106,"longitudeDecimal":-54.51,"latitudeDecimal":49.96,"elapsedTime":19497},{"sequenceNumber":107,"longitudeDecimal":-52,"latitudeDecimal":50,"elapsedTime":20075},{"sequenceNumber":108,"longitudeDecimal":-50,"latitudeDecimal":50,"elapsedTime":20538},{"sequenceNumber":109,"longitudeDecimal":-40,"latitudeDecimal":50,"elapsedTime":22956},{"sequenceNumber":110,"longitudeDecimal":-30,"latitudeDecimal":51,"elapsedTime":25525},{"sequenceNumber":111,"longitudeDecimal":-20,"latitudeDecimal":52,"elapsedTime":28128},{"sequenceNumber":112,"longitudeDecimal":-15,"latitudeDecimal":52,"elapsedTime":29406},{"sequenceNumber":113,"longitudeDecimal":-6.25,"latitudeDecimal":51.95,"elapsedTime":31556},{"sequenceNumber":114,"longitudeDecimal":-6.24,"latitudeDecimal":51.95,"elapsedTime":31558},{"sequenceNumber":115,"longitudeDecimal":-3.9,"latitudeDecimal":51.78,"elapsedTime":32124},{"sequenceNumber":116,"longitudeDecimal":-2.87,"latitudeDecimal":51.69,"elapsedTime":32376},{"sequenceNumber":117,"longitudeDecimal":-0.46,"latitudeDecimal":51.44,"elapsedTime":32970},{"sequenceNumber":118,"longitudeDecimal":-0.34,"latitudeDecimal":51.43,"elapsedTime":33001},{"sequenceNumber":119,"longitudeDecimal":0.92,"latitudeDecimal":51.27,"elapsedTime":33315},{"sequenceNumber":120,"longitudeDecimal":1.92,"latitudeDecimal":51.14,"elapsedTime":33563},{"sequenceNumber":121,"longitudeDecimal":2,"latitudeDecimal":51.13,"elapsedTime":33584},{"sequenceNumber":122,"longitudeDecimal":2.65,"latitudeDecimal":51.1,"elapsedTime":33744},{"sequenceNumber":123,"longitudeDecimal":3.71,"latitudeDecimal":50.9,"elapsedTime":34014},{"sequenceNumber":124,"longitudeDecimal":4.05,"latitudeDecimal":50.83,"elapsedTime":34107},{"sequenceNumber":125,"longitudeDecimal":4.11,"latitudeDecimal":50.82,"elapsedTime":34125},{"sequenceNumber":126,"longitudeDecimal":4.13,"latitudeDecimal":50.82,"elapsedTime":34132},{"sequenceNumber":127,"longitudeDecimal":4.46,"latitudeDecimal":50.75,"elapsedTime":34231},{"sequenceNumber":128,"longitudeDecimal":4.86,"latitudeDecimal":50.67,"elapsedTime":34363},{"sequenceNumber":129,"longitudeDecimal":4.92,"latitudeDecimal":50.66,"elapsedTime":34382},{"sequenceNumber":130,"longitudeDecimal":5.43,"latitudeDecimal":50.25,"elapsedTime":34697},{"sequenceNumber":131,"longitudeDecimal":5.6,"latitudeDecimal":50.12,"elapsedTime":34813},{"sequenceNumber":132,"longitudeDecimal":5.81,"latitudeDecimal":49.95,"elapsedTime":34973},{"sequenceNumber":133,"longitudeDecimal":5.97,"latitudeDecimal":49.82,"elapsedTime":35116},{"sequenceNumber":134,"longitudeDecimal":6.03,"latitudeDecimal":49.77,"elapsedTime":35181},{"sequenceNumber":135,"longitudeDecimal":6.05,"latitudeDecimal":49.75,"elapsedTime":35201},{"sequenceNumber":136,"longitudeDecimal":6.13,"latitudeDecimal":49.69,"elapsedTime":35298},{"sequenceNumber":137,"longitudeDecimal":6.2,"latitudeDecimal":49.62,"elapsedTime":35416}],

"nxce:sector":[{"sequenceNumber":1,"content":"ZLALAX"},{"sequenceNumber":2,"elapsedEntryTime":408,"content":"ZLA21"},{"sequenceNumber":3,"elapsedEntryTime":663,"content":"ZLA18"},{"sequenceNumber":4,"elapsedEntryTime":686,"content":"ZLA38"},{"sequenceNumber":5,"elapsedEntryTime":1720,"content":"ZLA34"},{"sequenceNumber":6,"elapsedEntryTime":2363,"content":"ZLA54"},{"sequenceNumber":7,"elapsedEntryTime":3200,"content":"ZDV23"},{"sequenceNumber":8,"elapsedEntryTime":4158,"content":"ZDV37"},{"sequenceNumber":9,"elapsedEntryTime":4691,"content":"ZDV25"},{"sequenceNumber":10,"elapsedEntryTime":5502,"content":"ZDV29"},{"sequenceNumber":11,"elapsedEntryTime":5938,"content":"ZDV28"},{"sequenceNumber":12,"elapsedEntryTime":6022,"content":"ZDV61"},{"sequenceNumber":13,"elapsedEntryTime":6340,"content":"ZDV17"},{"sequenceNumber":14,"elapsedEntryTime":6367,"content":"ZDV08"},{"sequenceNumber":15,"elapsedEntryTime":7336,"content":"ZDV09"},{"sequenceNumber":16,"elapsedEntryTime":7884,"content":"ZMP39"},{"sequenceNumber":17,"elapsedEntryTime":8564,"content":"ZMP29"},{"sequenceNumber":18,"elapsedEntryTime":8855,"content":"ZMP30"},{"sequenceNumber":19,"elapsedEntryTime":9612,"content":"ZMP17"},{"sequenceNumber":20,"elapsedEntryTime":10347,"content":"ZMP15"},{"sequenceNumber":21,"elapsedEntryTime":10629,"content":"ZAU60"},{"sequenceNumber":22,"elapsedEntryTime":10863,"content":"ZMP16"},{"sequenceNumber":23,"elapsedEntryTime":10886,"content":"ZMP13"},{"sequenceNumber":24,"elapsedEntryTime":11599,"content":"ZMP14"},{"sequenceNumber":25,"elapsedEntryTime":12491,"content":"YZRA2"},{"sequenceNumber":26,"elapsedEntryTime":12525,"content":"YZRA1"},{"sequenceNumber":27,"elapsedEntryTime":13055,"content":"YZXI1"},{"sequenceNumber":28,"elapsedEntryTime":13801,"content":"CZUNR"},{"sequenceNumber":29,"elapsedEntryTime":13821,"content":"CZUPO"},{"sequenceNumber":30,"elapsedEntryTime":14876,"content":"CZULE"},{"sequenceNumber":31,"elapsedEntryTime":15936,"content":"QMZV"},{"sequenceNumber":32,"elapsedEntryTime":17318,"content":"QMBO"},{"sequenceNumber":33,"elapsedEntryTime":17379,"content":"QMNA"},{"sequenceNumber":34,"elapsedEntryTime":17801,"content":"QMHI"},{"sequenceNumber":35,"elapsedEntryTime":18392,"content":"QMGR"},{"sequenceNumber":36,"elapsedEntryTime":18598,"content":"QXAY"},{"sequenceNumber":37,"elapsedEntryTime":18821,"content":"QXTP"},{"sequenceNumber":38,"elapsedEntryTime":20075,"content":"QXGN"},{"sequenceNumber":39,"elapsedEntryTime":20538,"content":"CZX00"},{"sequenceNumber":40,"elapsedEntryTime":25525,"content":"ZSW00"},{"sequenceNumber":41,"elapsedEntryTime":29406,"content":"SNCOR"},{"sequenceNumber":42,"elapsedEntryTime":31556,"content":"LNSTU"},{"sequenceNumber":43,"elapsedEntryTime":32124,"content":"ZLN00"},{"sequenceNumber":44,"elapsedEntryTime":32376,"content":"LNBRS"},{"sequenceNumber":45,"elapsedEntryTime":32970,"content":"ZLN00"},{"sequenceNumber":46,"elapsedEntryTime":33001,"content":"LNDVL"},{"sequenceNumber":47,"elapsedEntryTime":33315,"content":"LNDVH"},{"sequenceNumber":48,"elapsedEntryTime":33563,"content":"ZLN00"}],"nxce:center":[{"sequenceNumber":1,"content":"ZLA"},{"sequenceNumber":2,"elapsedEntryTime":3200,"content":"ZDV"},{"sequenceNumber":3,"elapsedEntryTime":7884,"content":"ZMP"},{"sequenceNumber":4,"elapsedEntryTime":10629,"content":"ZAU"},{"sequenceNumber":5,"elapsedEntryTime":10863,"content":"ZMP"},{"sequenceNumber":6,"elapsedEntryTime":12491,"content":"CZY"},{"sequenceNumber":7,"elapsedEntryTime":13801,"content":"CZU"},{"sequenceNumber":8,"elapsedEntryTime":15936,"content":"CZM"},{"sequenceNumber":9,"elapsedEntryTime":18598,"content":"CZQ"},{"sequenceNumber":10,"elapsedEntryTime":20538,"content":"CZX"},{"sequenceNumber":11,"elapsedEntryTime":25525,"content":"ZEU"},{"sequenceNumber":12,"elapsedEntryTime":29406,"content":"ZEU"}],"nxce:fix":[{"sequenceNumber":1,"content":"LAX"},{"sequenceNumber":2,"content":"DLREY","elapsedTime":38},{"sequenceNumber":3,"content":"ENNEY","elapsedTime":62},{"sequenceNumber":4,"content":"NAANC","elapsedTime":131},{"sequenceNumber":5,"content":"HAYNK","elapsedTime":186},{"sequenceNumber":6,"content":"PEVEE","elapsedTime":279},{"sequenceNumber":7,"content":"HOLTZ","elapsedTime":359},{"sequenceNumber":8,"content":"OSHNN","elapsedTime":423},{"sequenceNumber":9,"content":"CAHIL","elapsedTime":574},{"sequenceNumber":10,"content":"ZOOMM","elapsedTime":604},{"sequenceNumber":11,"content":"SEBBY","elapsedTime":690},{"sequenceNumber":12,"content":"PLAYY","elapsedTime":836},{"sequenceNumber":13,"content":"ARCUS","elapsedTime":1013},{"sequenceNumber":14,"content":"YELAH","elapsedTime":1227},{"sequenceNumber":15,"content":"WYZEE","elapsedTime":1766},{"sequenceNumber":16,"content":"BEALE","elapsedTime":2095},{"sequenceNumber":17,"content":"NOOTN","elapsedTime":2630},{"sequenceNumber":18,"content":"BETHL","elapsedTime":2947},{"sequenceNumber":19,"content":"FREDD","elapsedTime":2979},{"sequenceNumber":20,"content":"DICEE","elapsedTime":3392},{"sequenceNumber":21,"content":"DVC","elapsedTime":4214},{"sequenceNumber":22,"content":"OBH","elapsedTime":8135},{"sequenceNumber":23,"content":"GRB","elapsedTime":11272},{"sequenceNumber":24,"content":"ANCER","elapsedTime":15936},{"sequenceNumber":25,"content":"BUDAR","elapsedTime":20075},{"sequenceNumber":26,"content":"LIMRI","elapsedTime":29406},{"sequenceNumber":27,"content":"BANBA","elapsedTime":31558},{"sequenceNumber":28,"content":"KONAN","elapsedTime":33584},{"sequenceNumber":29,"content":"KOK","elapsedTime":33744},{"sequenceNumber":30,"content":"REMBA","elapsedTime":34382},{"sequenceNumber":31,"content":"ELLX","elapsedTime":35416}],

"nxce:airway":[{"sequenceNumber":1,"content":"OSHNN9"},{"sequenceNumber":2,"content":"J146"},{"sequenceNumber":3,"content":"N369A"}]},"nxcm:nextPosition":{"longitudeDecimal":-73.76439114513357,"latitudeDecimal":47.88219108915428},"nxcm:eta":{"etaType":"ESTIMATED","timeValue":"2021-02-16T02:04:16Z"},"nxcm:routeOfFlight":"KLAX./.4541N/08327W..ANCER.N369A.BUDAR..5000N/05000W..5000N/04000W..5100N/03000W..5200N/02000W..LIMRI..XETBO..BANBA..KONAN..UL607..KOK..REMBA..ELLX","nxcm:diversionIndicator":"NO_DIVERSION","nxcm:dpTransitionFix":"BEALE","nxcm:etd":{"timeValue":"2021-02-15T16:14:00Z","etdType":"ACTUAL"},"nxcm:dp":{"routeType":"DIRECT","routeName":"OSHNN9"},"nxcm:departureFixAndTime":{"fixName":"SEBBY","arrTime":"2021-02-15T16:25:30Z"}},"nxcm:speed":630,"nxcm:position":{"nxce:latitude":{"nxce:latitudeDMS":{"minutes":21,"degrees":47,"direction":"NORTH"}},"nxce:longitude":{"nxce:longitudeDMS":{"minutes":23,"degrees":"076","direction":"WEST"}}},"nxcm:timeAtPosition":"2021-02-15T20:11:15Z","nxcm:qualifiedAircraftId":{"nxce:departurePoint":{"nxce:airport":"KLAX"},"nxce:computerId":{"nxce:facilityIdentifier":"CCZY"},"nxce:igtd":"2021-02-15T16:15:00Z","nxce:gufi":"KL43561200","nxce:arrivalPoint":{"nxce:airport":"ELLX"},"nxce:aircraftId":"CLX45B"},"nxcm:reportedAltitude":{"nxce:assignedAltitude":{"nxce:simpleAltitude":330}}},"sensitivity":"A","airline":"CLX","arrArpt":"ELLX","cdmPart":False,"fdTrigger":"HCS_TRACK_MSG"}

def connect(hostIP, root_password):
     conn = pymysql.connect(host=hostIP, user='', password= root_password, db='', charset='utf8')
     cursor = conn.cursor()
     return conn, cursor

def read_csv():
    with open(f"{directory}.csv", newline='') as csvfile:
        csvreader = csv.reader(csvfile, delimiter=' ', quotechar='|')
    return csvreader

def new_dict():
    new_dict = {}
    new_dict['flight_reference'] = dictionary['flightRef']
    new_dict['sourceTimeStamp'] = dictionary['sourceTimeStamp']
    new_dict['departure'] = dictionary['depArpt']
    new_dict['arrival'] = dictionary['arrArpt']

    latitude = []
    longitude = []
    elapsedTime = []
    for i in dictionary['fdm:trackInformation']['nxcm:ncsmRouteData']['nxcm:flightTraversalData2']['nxce:waypoint']:
        elapse = i.get("elapsedTime")
        if not elapse:
            elapsedTime.append([0])
            latitude.append(i['latitudeDecimal'])
            longitude.append(i['longitudeDecimal'])
        else:
            latitude.append(i['latitudeDecimal'])
            longitude.append(i['longitudeDecimal'])
            elapsedTime.append(i['elapsedTime'])

    new_dict['latititude_data'] = latitude
    new_dict['longitude_data'] = longitude
    new_dict['elapsedTime'] = elapsedTime

    return new_dict

def filter_BOS(dict_):
    filtered_dict = {}
    for i in dict_():
        if i['arrival'] == 'BOS':
            filtered_dict.append(i)
    return filtered_dict


def send_SQL(dict):
    conn, cursor = connect('','')
    for i in range(len(dict)):
        sql = "insert into x (flight_reference,sourceTimeStamp,departure,arrival,latititude_data,longitude_data,elapsedTime) values (%s, %s, %s, %s, %s, %s, %s)"
        curs.execute(sql,(dict['flight_reference'][i],dict['sourceTimeStamp'][i],dict['departure'][i],dict['arrival'][i],dict['latititude_data'][i],dict['longitude_data'][i],dict['elapsedTime'][i]))
    conn.commit()
    conn.close()
